2025-04-24 14:34:13 [root] INFO: ==================================================
2025-04-24 14:34:13 [root] INFO: 网格交易系统启动
2025-04-24 14:34:13 [root] INFO: ==================================================
2025-04-24 14:34:13 [ExchangeClient] INFO: 交易所客户端初始化完成
2025-04-24 14:34:13 [PositionControllerS1] INFO: S1 Position Controller initialized. Lookback=52 days, Sell Target=50.0%, Buy Target=70.0%.
2025-04-24 14:34:13 [GridTrader] INFO: 正在加载市场数据...
2025-04-24 14:34:15 [ExchangeClient] INFO: 时间同步完成 | 时差: 68ms
2025-04-24 14:34:17 [ExchangeClient] INFO: 市场数据加载成功 | 交易对: SOL/USDT
2025-04-24 14:34:19 [ExchangeClient] INFO: 理财账户余额: {'SOL': 0.37439765, 'USDT': 292.1994597}
2025-04-24 14:34:20 [GridTrader] INFO: 总资产: 415.10 USDT | 现货: 67.20 USDT (SOL: 0.2847, USDT: 24.84) | 理财: 347.91 USDT (SOL: 0.3744, USDT: 292.20)
2025-04-24 14:34:20 [GridTrader] INFO: 从理财赎回USDT: 41.573429805935994
2025-04-24 14:34:20 [ExchangeClient] INFO: 找到USDT活期理财产品: USDT001
2025-04-24 14:34:20 [ExchangeClient] INFO: 开始赎回: 41.57 USDT 到现货
2025-04-24 14:34:21 [ExchangeClient] INFO: 划转成功: {'redeemId': 573270343, 'success': True}
2025-04-24 14:34:21 [GridTrader] INFO: 已从理财赎回 41.57 USDT
2025-04-24 14:34:21 [GridTrader] INFO: 从理财赎回SOL: 0.16171651149160565
2025-04-24 14:34:21 [ExchangeClient] INFO: 找到SOL活期理财产品: SOL001
2025-04-24 14:34:21 [ExchangeClient] INFO: 开始赎回: 0.16171651 SOL 到现货
2025-04-24 14:34:22 [ExchangeClient] INFO: 划转成功: {'redeemId': 573270356, 'success': True}
2025-04-24 14:34:22 [GridTrader] INFO: 已从理财赎回 0.1617 SOL
2025-04-24 14:34:22 [GridTrader] INFO: 资金分配完成
USDT: 317.04
SOL: 0.6591
2025-04-24 14:34:22 [GridTrader] INFO: 使用预设基准价: 143.91
2025-04-24 14:34:22 [GridTrader] INFO: 初始化完成 | 交易对: SOL/USDT | 基准价: 143.91
2025-04-24 14:34:22 [root] INFO: 正在发送推送通知: 交易信号通知
2025-04-24 14:34:23 [root] INFO: 消息推送成功: 网格交易启动成功
交易对: SOL/USDT
基准价: 143.91 USDT
网格大小: 2.0%
触发阈值: 0.4% (网格大小的1/5)
2025-04-24 14:34:23 [GridTrader] INFO: 市场当前价: 148.7900 | 价差: +3.39%
2025-04-24 14:34:23 [GridTrader] INFO: 正在获取最近10条交易记录...
2025-04-24 14:34:23 [ExchangeClient] INFO: 成功获取 7 条最近成交记录 for SOL/USDT
2025-04-24 14:34:23 [OrderTracker] INFO: 已将 7 条交易记录保存到 D:\code\GridBNB-USDT\data\trade_history.json
2025-04-24 14:34:23 [GridTrader] INFO: 已使用最新的 7 条交易记录更新历史。
2025-04-24 14:34:23 [TrendAnalyzer] INFO: 趋势分析器初始化
2025-04-24 14:34:23 [TrendTradingSystem] INFO: 趋势交易系统初始化
2025-04-24 14:34:23 [MultiTimeframeTrendSystem] INFO: 多周期趋势系统初始化
2025-04-24 14:34:23 [TrendMain] INFO: 趋势主系统初始化完成 - 交易对: BTC/USDT, 模式: 模拟
2025-04-24 14:34:23 [TrendMain] INFO: 启动持续趋势分析 - 检测间隔: 60秒
2025-04-24 14:34:23 [TrendMain] INFO: 开始新一轮分析 - 2025-04-24 14:34:23
2025-04-24 14:34:23 [TrendMain] INFO: 开始趋势分析 - BTC/USDT
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 使用模拟模式，无需连接交易所
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 获取 BTC/USDT 1d 周期数据, limit=100
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 使用模拟数据
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 获取 BTC/USDT 4h 周期数据, limit=100
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 使用模拟数据
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 获取 BTC/USDT 1h 周期数据, limit=100
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 使用模拟数据
2025-04-24 14:34:23 [MultiTimeframeTrendSystem] INFO: 长周期趋势: 上升趋势
2025-04-24 14:34:23 [MultiTimeframeTrendSystem] INFO: 中周期趋势: 上升趋势
2025-04-24 14:34:23 [MultiTimeframeTrendSystem] INFO: 短周期趋势: 下降趋势
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 分析结果:
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 长周期趋势: 上升趋势
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 中周期趋势: 上升趋势
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 短周期趋势: 下降趋势
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 交易信号: 持有
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 趋势一致性: False
2025-04-24 14:34:23 [TrendAnalyzerRunner] INFO: 分析结果已保存到 trend_signals/BTC_USDT_latest.json
2025-04-24 14:34:23 [TrendMain] INFO: 增强交易信号 - BTC/USDT:
2025-04-24 14:34:23 [TrendMain] INFO: 信号类型: 持有
2025-04-24 14:34:23 [TrendMain] INFO: 建议操作: 建议观望
2025-04-24 14:34:23 [TrendMain] INFO: 建议仓位: 0.0
2025-04-24 14:34:23 [TrendMain] INFO: 信号置信度: 低
2025-04-24 14:34:23 [TrendMain] INFO: 市场状态: 中长期上涨，短期回调
2025-04-24 14:34:23 [TrendMain] INFO: 增强信号已保存到 trend_signals/BTC_USDT_signal.json
2025-04-24 14:34:23 [TrendMain] INFO: 等待 60.0 秒进行下一轮分析，预计时间: 14:35:23
2025-04-24 14:34:23 [PositionControllerS1] INFO: S1: Time to update daily high/low levels...
2025-04-24 14:34:23 [root] INFO: Web服务已启动:
2025-04-24 14:34:23 [root] INFO: - 本地访问: http://localhost:58181
2025-04-24 14:34:23 [root] INFO: - 局域网访问: http://0.0.0.0:58181
2025-04-24 14:34:24 [PositionControllerS1] INFO: S1 Levels Updated: High=179.4700, Low=95.2600
2025-04-24 14:34:24 [GridTrader] INFO: 卖出监测 | 当前价: 148.80 | 触发价(动态): 148.20480 | 最高价: 148.80
2025-04-24 14:34:25 [ExchangeClient] INFO: 理财账户余额: {'SOL': 0.21268117, 'USDT': 250.62946974}
2025-04-24 14:34:36 [TrendMain] INFO: 持续分析已被取消
2025-04-24 14:34:36 [TrendMain] INFO: 持续分析已停止
2025-04-24 14:34:36 [ExchangeClient] INFO: 交易所连接已安全关闭
2025-04-24 14:34:36 [root] INFO: 交易所连接已关闭
2025-04-24 14:38:45 [root] INFO: ==================================================
2025-04-24 14:38:45 [root] INFO: 网格交易系统启动
2025-04-24 14:38:45 [root] INFO: ==================================================
2025-04-24 14:38:45 [ExchangeClient] INFO: 交易所客户端初始化完成
2025-04-24 14:38:45 [OrderTracker] INFO: 加载了 7 条历史交易记录
2025-04-24 14:38:45 [PositionControllerS1] INFO: S1 Position Controller initialized. Lookback=52 days, Sell Target=50.0%, Buy Target=70.0%.
2025-04-24 14:38:45 [GridTrader] INFO: 正在加载市场数据...
2025-04-24 14:38:47 [ExchangeClient] INFO: 时间同步完成 | 时差: 72ms
2025-04-24 14:38:50 [ExchangeClient] INFO: 市场数据加载成功 | 交易对: SOL/USDT
2025-04-24 14:38:52 [ExchangeClient] INFO: 理财账户余额: {'SOL': 0.21268123, 'USDT': 250.6295042}
2025-04-24 14:38:53 [GridTrader] INFO: 总资产: 415.05 USDT | 现货: 132.79 USDT (SOL: 0.4464, USDT: 66.41) | 理财: 282.26 USDT (SOL: 0.2127, USDT: 250.63)
2025-04-24 14:38:53 [GridTrader] INFO: 发现可划转USDT: 0.0049968973119973725
2025-04-24 14:38:53 [GridTrader] INFO: 可划转USDT (0.00) 低于最小申购额 1.0 USDT，跳过申购
2025-04-24 14:38:53 [GridTrader] INFO: 从理财赎回SOL: 0.00018346988560286048
2025-04-24 14:38:53 [ExchangeClient] INFO: 找到SOL活期理财产品: SOL001
2025-04-24 14:38:53 [ExchangeClient] INFO: 开始赎回: 0.00018347 SOL 到现货
2025-04-24 14:38:54 [ExchangeClient] ERROR: 赎回失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:38:54 [GridTrader] ERROR: 从理财赎回SOL失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:38:54 [GridTrader] INFO: 资金分配完成
USDT: 317.04
SOL: 0.6591
2025-04-24 14:38:54 [GridTrader] INFO: 使用预设基准价: 143.91
2025-04-24 14:38:54 [GridTrader] INFO: 初始化完成 | 交易对: SOL/USDT | 基准价: 143.91
2025-04-24 14:38:54 [root] INFO: 正在发送推送通知: 交易信号通知
2025-04-24 14:38:54 [root] INFO: 消息推送成功: 网格交易启动成功
交易对: SOL/USDT
基准价: 143.91 USDT
网格大小: 2.0%
触发阈值: 0.4% (网格大小的1/5)
2025-04-24 14:38:55 [GridTrader] INFO: 市场当前价: 148.7100 | 价差: +3.34%
2025-04-24 14:38:55 [GridTrader] INFO: 正在获取最近10条交易记录...
2025-04-24 14:38:55 [ExchangeClient] INFO: 成功获取 7 条最近成交记录 for SOL/USDT
2025-04-24 14:38:55 [OrderTracker] INFO: 交易历史备份成功
2025-04-24 14:38:55 [OrderTracker] INFO: 已将 7 条交易记录保存到 D:\code\GridBNB-USDT\data\trade_history.json
2025-04-24 14:38:55 [GridTrader] INFO: 已使用最新的 7 条交易记录更新历史。
2025-04-24 14:38:55 [TrendAnalyzer] INFO: 趋势分析器初始化
2025-04-24 14:38:55 [TrendTradingSystem] INFO: 趋势交易系统初始化
2025-04-24 14:38:55 [MultiTimeframeTrendSystem] INFO: 多周期趋势系统初始化
2025-04-24 14:38:55 [TrendMain] INFO: 趋势主系统初始化完成 - 交易对: SOL/USDT, 模式: 实盘
2025-04-24 14:38:55 [TrendMain] INFO: 启动持续趋势分析 - 检测间隔: 60秒
2025-04-24 14:38:55 [TrendMain] INFO: 开始新一轮分析 - 2025-04-24 14:38:55
2025-04-24 14:38:55 [TrendMain] INFO: 开始趋势分析 - SOL/USDT
2025-04-24 14:38:55 [TrendAnalyzerRunner] INFO: 初始化交易所连接: binance
2025-04-24 14:38:55 [PositionControllerS1] INFO: S1: Time to update daily high/low levels...
2025-04-24 14:38:55 [root] INFO: Web服务已启动:
2025-04-24 14:38:55 [root] INFO: - 本地访问: http://localhost:58181
2025-04-24 14:38:55 [root] INFO: - 局域网访问: http://0.0.0.0:58181
2025-04-24 14:38:56 [PositionControllerS1] INFO: S1 Levels Updated: High=179.4700, Low=95.2600
2025-04-24 14:38:56 [GridTrader] INFO: 卖出监测 | 当前价: 148.71 | 触发价(动态): 148.11516 | 最高价: 148.71
2025-04-24 14:38:57 [TrendAnalyzerRunner] INFO: 交易所连接成功，交易对: SOL/USDT
2025-04-24 14:38:57 [TrendAnalyzerRunner] INFO: 获取 SOL/USDT 1d 周期数据, limit=100
2025-04-24 14:38:57 [TrendAnalyzerRunner] INFO: 获取 SOL/USDT 4h 周期数据, limit=100
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 获取 SOL/USDT 1h 周期数据, limit=100
2025-04-24 14:38:58 [MultiTimeframeTrendSystem] INFO: 长周期趋势: 上升趋势
2025-04-24 14:38:58 [MultiTimeframeTrendSystem] INFO: 中周期趋势: 上升趋势
2025-04-24 14:38:58 [MultiTimeframeTrendSystem] INFO: 短周期趋势: 盘整
2025-04-24 14:38:58 [TrendTradingSystem] INFO: EMA趋势: 上升趋势
2025-04-24 14:38:58 [TrendTradingSystem] INFO: MACD趋势: 上升趋势
2025-04-24 14:38:58 [TrendTradingSystem] INFO: RSI趋势: 盘整
2025-04-24 14:38:58 [TrendTradingSystem] INFO: KDJ趋势: 下降趋势
2025-04-24 14:38:58 [TrendTradingSystem] INFO: 交易信号: {'signal': '持有', 'position_size': 0, 'stop_loss': 0, 'take_profit': 0, 'current_price': 148.71}
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 分析结果:
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 长周期趋势: 上升趋势
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 中周期趋势: 上升趋势
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 短周期趋势: 盘整
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 交易信号: 持有
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 趋势一致性: False
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 分析结果已保存到 trend_signals/SOL_USDT_latest.json
2025-04-24 14:38:58 [TrendAnalyzerRunner] INFO: 交易所连接已关闭
2025-04-24 14:38:58 [TrendMain] INFO: 增强交易信号 - SOL/USDT:
2025-04-24 14:38:58 [TrendMain] INFO: 信号类型: 持有
2025-04-24 14:38:58 [TrendMain] INFO: 建议操作: 建议观望
2025-04-24 14:38:58 [TrendMain] INFO: 建议仓位: 0.0
2025-04-24 14:38:58 [TrendMain] INFO: 信号置信度: 低
2025-04-24 14:38:58 [TrendMain] INFO: 市场状态: 中长期上涨，短期盘整
2025-04-24 14:38:58 [TrendMain] INFO: 增强信号已保存到 trend_signals/SOL_USDT_signal.json
2025-04-24 14:38:58 [TrendMain] INFO: 等待 56.7 秒进行下一轮分析，预计时间: 14:39:55
2025-04-24 14:39:30 [TrendMain] INFO: 持续分析已被取消
2025-04-24 14:39:30 [TrendMain] INFO: 持续分析已停止
2025-04-24 14:39:30 [ExchangeClient] INFO: 交易所连接已安全关闭
2025-04-24 14:39:30 [root] INFO: 交易所连接已关闭
2025-04-24 14:40:29 [root] INFO: ==================================================
2025-04-24 14:40:29 [root] INFO: 网格交易系统启动
2025-04-24 14:40:29 [root] INFO: ==================================================
2025-04-24 14:40:29 [ExchangeClient] INFO: 交易所客户端初始化完成
2025-04-24 14:40:29 [OrderTracker] INFO: 加载了 7 条历史交易记录
2025-04-24 14:40:29 [PositionControllerS1] INFO: S1 Position Controller initialized. Lookback=52 days, Sell Target=50.0%, Buy Target=70.0%.
2025-04-24 14:40:29 [GridTrader] INFO: 正在加载市场数据...
2025-04-24 14:40:31 [ExchangeClient] INFO: 时间同步完成 | 时差: 67ms
2025-04-24 14:40:33 [ExchangeClient] INFO: 市场数据加载成功 | 交易对: SOL/USDT
2025-04-24 14:40:35 [ExchangeClient] INFO: 理财账户余额: {'SOL': 0.21268125, 'USDT': 250.62952145}
2025-04-24 14:40:36 [GridTrader] INFO: 总资产: 414.97 USDT | 现货: 132.74 USDT (SOL: 0.4464, USDT: 66.41) | 理财: 282.23 USDT (SOL: 0.2127, USDT: 250.63)
2025-04-24 14:40:36 [GridTrader] INFO: 发现可划转USDT: 0.017647610560004523
2025-04-24 14:40:36 [GridTrader] INFO: 可划转USDT (0.02) 低于最小申购额 1.0 USDT，跳过申购
2025-04-24 14:40:36 [GridTrader] INFO: 从理财赎回SOL: 0.0004589711652197015
2025-04-24 14:40:36 [ExchangeClient] INFO: 找到SOL活期理财产品: SOL001
2025-04-24 14:40:36 [ExchangeClient] INFO: 开始赎回: 0.00045897 SOL 到现货
2025-04-24 14:40:37 [ExchangeClient] ERROR: 赎回失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:40:37 [GridTrader] ERROR: 从理财赎回SOL失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:40:37 [GridTrader] INFO: 资金分配完成
USDT: 317.04
SOL: 0.6591
2025-04-24 14:40:37 [GridTrader] INFO: 使用预设基准价: 143.91
2025-04-24 14:40:37 [GridTrader] INFO: 初始化完成 | 交易对: SOL/USDT | 基准价: 143.91
2025-04-24 14:40:37 [root] INFO: 正在发送推送通知: 交易信号通知
2025-04-24 14:40:37 [root] INFO: 消息推送成功: 网格交易启动成功
交易对: SOL/USDT
基准价: 143.91 USDT
网格大小: 2.0%
触发阈值: 0.4% (网格大小的1/5)
2025-04-24 14:40:38 [GridTrader] INFO: 市场当前价: 148.6000 | 价差: +3.26%
2025-04-24 14:40:38 [GridTrader] INFO: 正在获取最近10条交易记录...
2025-04-24 14:40:38 [ExchangeClient] INFO: 成功获取 7 条最近成交记录 for SOL/USDT
2025-04-24 14:40:38 [OrderTracker] INFO: 交易历史备份成功
2025-04-24 14:40:38 [OrderTracker] INFO: 已将 7 条交易记录保存到 D:\code\GridBNB-USDT\data\trade_history.json
2025-04-24 14:40:38 [GridTrader] INFO: 已使用最新的 7 条交易记录更新历史。
2025-04-24 14:40:38 [root] ERROR: 启动失败: An asyncio.Future, a coroutine or an awaitable is required
Traceback (most recent call last):
  File "D:\code\GridBNB-USDT\main.py", line 54, in main
    await asyncio.gather(web_server_task, trading_task, trend_analyzer_task)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\tasks.py", line 831, in gather
    fut = ensure_future(arg, loop=loop)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\tasks.py", line 689, in ensure_future
    raise TypeError('An asyncio.Future, a coroutine or an awaitable '
TypeError: An asyncio.Future, a coroutine or an awaitable is required

2025-04-24 14:40:38 [root] INFO: 正在发送推送通知: 致命错误
2025-04-24 14:40:38 [root] INFO: 消息推送成功: 启动失败: An asyncio.Future, a coroutine or an awaitable is required
Traceback (most recent call last):
  File "D:\code\GridBNB-USDT\main.py", line 54, in main
    await asyncio.gather(web_server_task, trading_task, trend_analyzer_task)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\tasks.py", line 831, in gather
    fut = ensure_future(arg, loop=loop)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\asyncio\tasks.py", line 689, in ensure_future
    raise TypeError('An asyncio.Future, a coroutine or an awaitable '
TypeError: An asyncio.Future, a coroutine or an awaitable is required

2025-04-24 14:40:38 [PositionControllerS1] INFO: S1: Time to update daily high/low levels...
2025-04-24 14:40:38 [root] INFO: Web服务已启动:
2025-04-24 14:40:38 [root] INFO: - 本地访问: http://localhost:58181
2025-04-24 14:40:38 [root] INFO: - 局域网访问: http://0.0.0.0:58181
2025-04-24 14:40:38 [ExchangeClient] INFO: 交易所连接已安全关闭
2025-04-24 14:40:38 [root] INFO: 交易所连接已关闭
2025-04-24 14:40:38 [ccxt.base.exchange] WARNING: binance requires to release all resources with an explicit call to the .close() coroutine. If you are using the exchange instance with async coroutines, add `await exchange.close()` to your code into a place when you're done with the exchange and don't need the exchange instance anymore (at the end of your async coroutine).
2025-04-24 14:40:38 [asyncio] ERROR: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000020AA4E45910>
2025-04-24 14:41:24 [root] INFO: ==================================================
2025-04-24 14:41:24 [root] INFO: 网格交易系统启动
2025-04-24 14:41:24 [root] INFO: ==================================================
2025-04-24 14:41:24 [ExchangeClient] INFO: 交易所客户端初始化完成
2025-04-24 14:41:24 [OrderTracker] INFO: 加载了 7 条历史交易记录
2025-04-24 14:41:24 [PositionControllerS1] INFO: S1 Position Controller initialized. Lookback=52 days, Sell Target=50.0%, Buy Target=70.0%.
2025-04-24 14:41:24 [GridTrader] INFO: 正在加载市场数据...
2025-04-24 14:41:25 [ExchangeClient] INFO: 时间同步完成 | 时差: 26ms
2025-04-24 14:41:28 [ExchangeClient] INFO: 市场数据加载成功 | 交易对: SOL/USDT
2025-04-24 14:41:30 [ExchangeClient] INFO: 理财账户余额: {'SOL': 0.21268127, 'USDT': 250.62953008}
2025-04-24 14:41:31 [GridTrader] INFO: 总资产: 415.07 USDT | 现货: 132.81 USDT (SOL: 0.4464, USDT: 66.41) | 理财: 282.26 USDT (SOL: 0.2127, USDT: 250.63)
2025-04-24 14:41:31 [GridTrader] INFO: 发现可划转USDT: 0.0018283173920110585
2025-04-24 14:41:31 [GridTrader] INFO: 可划转USDT (0.00) 低于最小申购额 1.0 USDT，跳过申购
2025-04-24 14:41:31 [GridTrader] INFO: 从理财赎回SOL: 0.00011470370181515532
2025-04-24 14:41:31 [ExchangeClient] INFO: 找到SOL活期理财产品: SOL001
2025-04-24 14:41:31 [ExchangeClient] INFO: 开始赎回: 0.00011470 SOL 到现货
2025-04-24 14:41:32 [ExchangeClient] ERROR: 赎回失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:41:32 [GridTrader] ERROR: 从理财赎回SOL失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:41:32 [GridTrader] INFO: 资金分配完成
USDT: 317.04
SOL: 0.6591
2025-04-24 14:41:32 [GridTrader] INFO: 使用预设基准价: 143.91
2025-04-24 14:41:32 [GridTrader] INFO: 初始化完成 | 交易对: SOL/USDT | 基准价: 143.91
2025-04-24 14:41:32 [root] INFO: 正在发送推送通知: 交易信号通知
2025-04-24 14:41:33 [root] ERROR: 消息推送失败: 状态码=200, 响应={'code': 999, 'msg': '请勿频繁推送相同内容', 'data': None}
2025-04-24 14:41:33 [GridTrader] INFO: 市场当前价: 148.7400 | 价差: +3.36%
2025-04-24 14:41:33 [GridTrader] INFO: 正在获取最近10条交易记录...
2025-04-24 14:41:33 [ExchangeClient] INFO: 成功获取 7 条最近成交记录 for SOL/USDT
2025-04-24 14:41:33 [OrderTracker] INFO: 交易历史备份成功
2025-04-24 14:41:33 [OrderTracker] INFO: 已将 7 条交易记录保存到 D:\code\GridBNB-USDT\data\trade_history.json
2025-04-24 14:41:33 [GridTrader] INFO: 已使用最新的 7 条交易记录更新历史。
2025-04-24 14:41:33 [root] INFO: 趋势分析未启用
2025-04-24 14:41:33 [root] ERROR: 启动失败: cannot access local variable 'trend_analyzer_task' where it is not associated with a value
Traceback (most recent call last):
  File "D:\code\GridBNB-USDT\main.py", line 54, in main
    if trend_analyzer_task:
       ^^^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'trend_analyzer_task' where it is not associated with a value

2025-04-24 14:41:33 [root] INFO: 正在发送推送通知: 致命错误
2025-04-24 14:41:33 [root] INFO: 消息推送成功: 启动失败: cannot access local variable 'trend_analyzer_task' where it is not associated with a value
Traceback (most recent call last):
  File "D:\code\GridBNB-USDT\main.py", line 54, in main
    if trend_analyzer_task:
       ^^^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'trend_analyzer_task' where it is not associated with a value

2025-04-24 14:41:33 [PositionControllerS1] INFO: S1: Time to update daily high/low levels...
2025-04-24 14:41:33 [root] INFO: Web服务已启动:
2025-04-24 14:41:33 [root] INFO: - 本地访问: http://localhost:58181
2025-04-24 14:41:33 [root] INFO: - 局域网访问: http://0.0.0.0:58181
2025-04-24 14:41:34 [ExchangeClient] INFO: 交易所连接已安全关闭
2025-04-24 14:41:34 [root] INFO: 交易所连接已关闭
2025-04-24 14:41:34 [ccxt.base.exchange] WARNING: binance requires to release all resources with an explicit call to the .close() coroutine. If you are using the exchange instance with async coroutines, add `await exchange.close()` to your code into a place when you're done with the exchange and don't need the exchange instance anymore (at the end of your async coroutine).
2025-04-24 14:41:34 [asyncio] ERROR: Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000201E6A55430>
2025-04-24 14:41:51 [root] INFO: ==================================================
2025-04-24 14:41:51 [root] INFO: 网格交易系统启动
2025-04-24 14:41:51 [root] INFO: ==================================================
2025-04-24 14:41:51 [ExchangeClient] INFO: 交易所客户端初始化完成
2025-04-24 14:41:51 [OrderTracker] INFO: 加载了 7 条历史交易记录
2025-04-24 14:41:51 [PositionControllerS1] INFO: S1 Position Controller initialized. Lookback=52 days, Sell Target=50.0%, Buy Target=70.0%.
2025-04-24 14:41:51 [GridTrader] INFO: 正在加载市场数据...
2025-04-24 14:41:52 [ExchangeClient] INFO: 时间同步完成 | 时差: 57ms
2025-04-24 14:41:55 [ExchangeClient] INFO: 市场数据加载成功 | 交易对: SOL/USDT
2025-04-24 14:41:56 [ExchangeClient] INFO: 理财账户余额: {'SOL': 0.21268127, 'USDT': 250.62953008}
2025-04-24 14:41:57 [GridTrader] INFO: 总资产: 415.09 USDT | 现货: 132.82 USDT (SOL: 0.4464, USDT: 66.41) | 理财: 282.27 USDT (SOL: 0.2127, USDT: 250.63)
2025-04-24 14:41:58 [GridTrader] INFO: 从理财赎回USDT: 0.0013351699840029596
2025-04-24 14:41:58 [ExchangeClient] INFO: 找到USDT活期理财产品: USDT001
2025-04-24 14:41:58 [ExchangeClient] INFO: 开始赎回: 0.00 USDT 到现货
2025-04-24 14:41:59 [ExchangeClient] ERROR: 赎回失败: binance {"code":-1102,"msg":"Mandatory parameter 'amount' was not sent, was empty/null, or malformed."}
2025-04-24 14:41:59 [GridTrader] ERROR: 从理财赎回USDT失败: binance {"code":-1102,"msg":"Mandatory parameter 'amount' was not sent, was empty/null, or malformed."}
2025-04-24 14:41:59 [GridTrader] INFO: 从理财赎回SOL: 4.593102093164436e-05
2025-04-24 14:41:59 [ExchangeClient] INFO: 找到SOL活期理财产品: SOL001
2025-04-24 14:41:59 [ExchangeClient] INFO: 开始赎回: 0.00004593 SOL 到现货
2025-04-24 14:42:00 [ExchangeClient] ERROR: 赎回失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:42:00 [GridTrader] ERROR: 从理财赎回SOL失败: binance {"code":-6006,"msg":"redeem amount error"}
2025-04-24 14:42:00 [GridTrader] INFO: 资金分配完成
USDT: 317.04
SOL: 0.6591
2025-04-24 14:42:00 [GridTrader] INFO: 使用预设基准价: 143.91
2025-04-24 14:42:00 [GridTrader] INFO: 初始化完成 | 交易对: SOL/USDT | 基准价: 143.91
2025-04-24 14:42:00 [root] INFO: 正在发送推送通知: 交易信号通知
2025-04-24 14:42:00 [root] ERROR: 消息推送失败: 状态码=200, 响应={'code': 999, 'msg': '请勿频繁推送相同内容', 'data': None}
2025-04-24 14:42:01 [GridTrader] INFO: 市场当前价: 148.7800 | 价差: +3.38%
2025-04-24 14:42:01 [GridTrader] INFO: 正在获取最近10条交易记录...
2025-04-24 14:42:01 [ExchangeClient] INFO: 成功获取 7 条最近成交记录 for SOL/USDT
2025-04-24 14:42:01 [OrderTracker] INFO: 交易历史备份成功
2025-04-24 14:42:01 [OrderTracker] INFO: 已将 7 条交易记录保存到 D:\code\GridBNB-USDT\data\trade_history.json
2025-04-24 14:42:01 [GridTrader] INFO: 已使用最新的 7 条交易记录更新历史。
2025-04-24 14:42:01 [root] INFO: 趋势分析未启用
2025-04-24 14:42:01 [PositionControllerS1] INFO: S1: Time to update daily high/low levels...
2025-04-24 14:42:01 [root] INFO: Web服务已启动:
2025-04-24 14:42:01 [root] INFO: - 本地访问: http://localhost:58181
2025-04-24 14:42:01 [root] INFO: - 局域网访问: http://0.0.0.0:58181
2025-04-24 14:42:01 [PositionControllerS1] INFO: S1 Levels Updated: High=179.4700, Low=95.2600
2025-04-24 14:42:02 [GridTrader] INFO: 卖出监测 | 当前价: 148.78 | 触发价(动态): 148.18488 | 最高价: 148.78
2025-04-24 14:42:08 [ExchangeClient] INFO: 交易所连接已安全关闭
2025-04-24 14:42:08 [root] INFO: 交易所连接已关闭
